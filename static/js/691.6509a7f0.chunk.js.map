{"version":3,"file":"static/js/691.6509a7f0.chunk.js","mappings":"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","sources":["../../lib/src/types/drawing.ts","../../lib/src/types/order.ts","shared/config.ts","features/canvas/helpers.ts","features/canvas/worker.ts","../webpack/bootstrap","../webpack/runtime/chunk loaded","../webpack/runtime/define property getters","../webpack/runtime/ensure chunk","../webpack/runtime/get javascript chunk filename","../webpack/runtime/get mini-css chunk filename","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/publicPath","../webpack/runtime/importScripts chunk loading","../webpack/runtime/startup chunk dependencies","../webpack/startup"],"sourcesContent":["import { Entity } from '.'\nimport { User } from './user'\n\nexport enum ActionType {\n  Open = 0,\n  Close = 1,\n  Stroke = 2,\n}\n\n/**\n * Reducing space as much as possible\n *\n * c: color\n * w: width/size\n * ts: unix timestamp\n */\n// better space would be, mini serializer needed\n// JSON.stringify([...Object.values({ x, y, t, w, st, ts })])\nexport interface DrawAction {\n  t: ActionType\n  x?: number\n  y?: number\n  c?: string\n  w?: number\n  ts?: number\n}\n\nexport interface Drawing extends Entity {\n  drawingId?: string\n  userId?: string\n  name: string\n  history: DrawAction[]\n  thumbnail?: string\n  private?: boolean\n  sell?: boolean\n  price?: number\n  hits?: number\n  user?: User\n}\n\n// might be better to add up all open closes hmm\nexport function getTimeSpent(d: Drawing): number {\n  if (!d?.history || d.history?.length < 2) {\n    return 0\n  }\n  const first = d.history[0].ts as number\n  const last = d.history[d.history.length - 1].ts as number\n  const millisecs = last - first\n  return millisecs\n}\n\nexport function getDuration(d: Drawing) {\n  const secs = Math.round(getTimeSpent(d) / 1000)\n  const mins = Math.round(secs / 60)\n  const hours = Math.round(mins / 60)\n  const rem = secs % 60\n  return `${hours}h:${mins}m:${rem}s`\n}\n","import { Entity } from '.'\nimport { User } from './user'\nimport { Drawing } from './drawing'\n\nexport enum OrderStatus {\n  Pending = 'pending',\n  Paid = 'paid',\n  Shipped = 'shipped',\n  Delivered = 'delivered',\n  Cancelled = 'cancelled',\n}\n\nexport interface OrderItem extends Entity {\n  orderItemId?: string\n  orderId?: string\n  drawingId?: string\n  price?: number\n  quantity?: number\n  drawing?: Drawing\n}\n\nexport interface Order extends Entity {\n  orderId?: string\n  userId?: string\n  billingAddressId?: string\n  shippingAddressId?: string\n  paymentMethodId?: string\n  total?: number\n  status?: OrderStatus\n  OrderItems?: OrderItem[]\n  user?: User\n}\n\nexport interface Payment extends Entity {\n  paymentId: string\n  userId: string\n  orderId: string\n  amount: number\n  currency: string\n  status?: string\n}\n\nexport enum PaymentSource {\n  Stripe = 'STRIPE',\n  PayPal = 'PAYPAL',\n}\n\nexport enum PaymentStatus {\n  Successful = 'COMPLETED',\n  Pending = 'PENDING',\n  Failed = 'FAILED',\n  Created = 'CREATED',\n}\n\nexport const StripeToPaymentStatusMap = {\n  canceled: PaymentStatus.Failed,\n  succeeded: PaymentStatus.Successful,\n  processing: PaymentStatus.Pending,\n  requires_action: PaymentStatus.Pending,\n  requires_capture: PaymentStatus.Pending,\n  requires_confirmation: PaymentStatus.Pending,\n  requires_payment_method: PaymentStatus.Pending,\n  unknown: PaymentStatus.Failed,\n}\n\nexport interface Subscription extends Entity {\n  subscriptionId: string\n  userId: string\n  orderId: string\n  amount: number\n  currency: string\n  status?: string\n}\n","/* eslint-disable no-console */\nimport axios from 'axios'\nimport { SettingTypes, SystemSettings } from '../../../lib/src/types'\nimport packageJson from '../../package.json'\n\nexport interface Config {\n  baseName: string\n  backendUrl: string\n  defaultTitle: string\n  defaultLineSize: number\n  defaultColor: string\n  thumbnails: {\n    width: number\n    height: number\n  }\n  auth: {\n    domain: string\n    baseUrl: string\n    redirectUrl: string\n    clientId: string\n    audience: string\n    google?: {\n      clientId: string\n    }\n  }\n  settings?: {\n    [SettingTypes.System]: SystemSettings\n  }\n  admin: {\n    path: string\n    models?: string[]\n  }\n  keys: {\n    stripe?: string\n    paypal?: string\n  }\n}\nconst env = process['env']\nconst defaultBaseName = process.env.NODE_ENV === 'test' ? '/' : packageJson.homepage || '/'\nexport const config: Config = {\n  baseName: env.BASE_NAME || defaultBaseName,\n  backendUrl: env.BACKEND || 'https://api.drawspace.app',\n  defaultTitle: 'Drawspace',\n  defaultColor: 'green',\n  defaultLineSize: 5,\n  thumbnails: {\n    width: 250,\n    height: 250,\n  },\n  auth: {\n    domain: `${env.AUTH_TENANT}.auth0.com`,\n    baseUrl: `https://${env.AUTH_TENANT}.auth0.com`,\n    audience: `https://backend`,\n    clientId: env.AUTH_CLIENT_ID || '',\n    redirectUrl: env.AUTH_REDIRECT_URL || 'https://api.drawspace.app/callback',\n    google: {\n      clientId: env.GOOGLE_CLIENT_ID || '',\n    },\n  },\n  admin: {\n    path: '/admin',\n    models: [],\n  },\n  keys: {\n    stripe: env.STRIPE_KEY || '',\n    paypal: env.PAYPAL_KEY || '',\n  },\n}\n\nexport async function applyConfig() {\n  axios.defaults.baseURL = config.backendUrl\n  // Remotish config\n  const serverConfig = (await axios.get('/config'))?.data\n  if (!serverConfig) {\n    return\n  }\n  Object.keys(serverConfig).forEach((key: string) => {\n    const indexed = config as unknown as { [key: string]: unknown }\n    if (typeof serverConfig[key] === 'object') {\n      indexed[key] = { ...(indexed[key] as { [key: string]: unknown }), ...serverConfig[key] }\n    } else {\n      indexed[key] = serverConfig[key]\n    }\n  })\n}\n\nexport default config\n","import { Drawing } from '@lib'\nimport { config } from '../../shared/config'\n\nexport function setBrushDefaults(\n  context: CanvasRenderingContext2D | OffscreenCanvasRenderingContext2D,\n) {\n  context.strokeStyle = config.defaultColor\n  context.lineWidth = config.defaultLineSize\n  context.lineCap = 'round'\n  context.lineJoin = 'round'\n  //context.miterLimit = 2\n}\n\nfunction setWH(canvas: HTMLCanvasElement, w: number, h: number) {\n  const context = canvas.getContext('2d')\n  const existing = canvas.getContext('2d')?.getImageData(0, 0, canvas.width, canvas.height)\n  const dpr = window.devicePixelRatio\n  canvas.width = w * dpr\n  canvas.height = h * dpr\n  context?.scale(dpr, dpr)\n  //https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Optimizing_canvas\n  canvas.style.width = w + 'px'\n  canvas.style.height = h + 'px'\n  if (existing) {\n    context?.putImageData(existing, 0, 0)\n  }\n}\n\nexport function adjustToResolution(canvas: HTMLCanvasElement, resize?: boolean) {\n  if (!canvas) {\n    return\n  }\n  const min = {\n    w: 375,\n    h: 667,\n  }\n  const iw = window.innerWidth - 20\n  const ih = window.innerHeight - 95\n  const w = iw < min.w ? min.w : iw\n  const h = ih < min.h ? min.h : ih\n  if ((resize && w < canvas.width) || h < canvas.height) {\n    return\n  }\n  setWH(canvas, w, h)\n}\n\nexport function adjustOffscreenResolution(\n  canvas: OffscreenCanvas,\n  width: number,\n  height: number,\n  dpr: number,\n) {\n  if (!canvas) {\n    return\n  }\n  canvas.width = width * dpr\n  canvas.height = height * dpr\n  canvas.getContext('2d')?.scale(dpr, dpr)\n}\n\nexport function createOffscreen(width: number, height: number, dpr: number) {\n  const offline = new OffscreenCanvas(width, height)\n  adjustOffscreenResolution(offline, width, height, dpr)\n  const context = offline.getContext('2d') as OffscreenCanvasRenderingContext2D\n  if (!context) {\n    return\n  }\n\n  setBrushDefaults(context)\n\n  return context\n}\n\nexport async function generateThumbnail(\n  canvas: HTMLCanvasElement,\n  width = config.thumbnails.width,\n  height = config.thumbnails.height,\n): Promise<string> {\n  const data = canvas.toDataURL()\n  const img = new Image(canvas.width, canvas.height)\n  img.src = data\n  img.height = height\n  img.width = width\n\n  const srcAsync = (): Promise<string> =>\n    new Promise(resolve => {\n      img.onload = () => {\n        const off = document.createElement('canvas')\n        off.width = width\n        off.height = height\n        const context = off.getContext('2d') as CanvasRenderingContext2D\n        context.drawImage(img, 0, 0, width, height)\n        const result = context.canvas.toDataURL()\n        resolve(result)\n      }\n    })\n\n  const result = await srcAsync()\n  return result\n}\n\nexport function getDraft() {\n  let draft: Drawing = {\n    drawingId: 'draft',\n    name: 'New Draft',\n    history: [],\n  }\n  const persisted = localStorage.getItem('canvas')\n  if (persisted?.includes('{')) {\n    draft = JSON.parse(persisted) as Drawing\n  }\n  return draft\n}\n\nexport function getCopy(original: Drawing) {\n  const active = { ...original, id: 'copy', name: 'Copy' }\n  active.createdAt = new Date()\n  active.updatedAt = active.createdAt\n  const ts = active.createdAt.getTime()\n  active.history.forEach(h => {\n    h.ts = ts\n  })\n  return active\n}\n\nexport function isEmptyCanvas(canvas: HTMLCanvasElement) {\n  const blank = document.createElement('canvas')\n  blank.width = canvas.width\n  blank.height = canvas.height\n  return canvas.toDataURL() === blank.toDataURL()\n}\n","import { ActionType, DrawAction } from '@lib'\nimport { createOffscreen } from './helpers'\n\nexport type WorkMessage = {\n  buffer: DrawAction[]\n  width: number\n  height: number\n  dpr: number\n  stopAt?: number\n  stream?: boolean\n}\n\nconst w = self as Window & typeof globalThis\n\nfunction send(background: OffscreenCanvasRenderingContext2D, width: number, height: number) {\n  try {\n    const data = background.getImageData(0, 0, width, height)\n    // eslint-disable-next-line\n    w?.postMessage(data)\n  } catch (err: unknown) {\n    // eslint-disable-next-line no-console\n    console.error(err)\n  }\n}\n\nfunction processHistory({ buffer, width, height, dpr, stream, stopAt }: WorkMessage) {\n  const background = createOffscreen(width, height, dpr)\n  if (!background) {\n    return\n  }\n\n  let i = 0\n  for (const { t, x, y, c, w } of buffer) {\n    if (c) {\n      background.strokeStyle = c\n    }\n    if (w) {\n      background.lineWidth = w\n    }\n    if (t === ActionType.Open) {\n      background.beginPath()\n    }\n    if ([ActionType.Open, ActionType.Stroke].includes(t)) {\n      background.lineTo(x as number, y as number)\n      background.stroke()\n    }\n    if (t === ActionType.Close) {\n      background.closePath()\n      if (stream) {\n        send(background, width, height)\n      }\n    }\n    if (stopAt === i) {\n      return\n    }\n    i += 1\n  }\n  send(background, width, height)\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nw.onmessage = ({ data }: { data: WorkMessage; ev?: MessageEvent<any> }) => {\n  processHistory(data)\n}\n\nexport {}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n// the startup function\n__webpack_require__.x = function() {\n\t// Load entry module and return exports\n\t// This entry module depends on other loaded chunks and execution need to be delayed\n\tvar __webpack_exports__ = __webpack_require__.O(undefined, [549], function() { return __webpack_require__(2691); })\n\t__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n\treturn __webpack_exports__;\n};\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.u = function(chunkId) {\n\t// return url for filenames based on template\n\treturn \"static/js/\" + chunkId + \".\" + \"f87f354d\" + \".chunk.js\";\n};","// This function allow to reference async chunks and sibling chunks for the entrypoint\n__webpack_require__.miniCssF = function(chunkId) {\n\t// return url for filenames based on template\n\treturn undefined;\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"/fullstack-monorepo/\";","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"already loaded\"\nvar installedChunks = {\n\t691: 1\n};\n\n// importScripts chunk loading\nvar installChunk = function(data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\twhile(chunkIds.length)\n\t\tinstalledChunks[chunkIds.pop()] = 1;\n\tparentChunkLoadingFunction(data);\n};\n__webpack_require__.f.i = function(chunkId, promises) {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\timportScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n\t\t}\n\t}\n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkclient\"] = self[\"webpackChunkclient\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;\n\n// no HMR\n\n// no HMR manifest","var next = __webpack_require__.x;\n__webpack_require__.x = function() {\n\treturn __webpack_require__.e(549).then(next);\n};","// run startup\nvar __webpack_exports__ = __webpack_require__.x();\n"],"names":["ActionType","OrderStatus","PaymentSource","PaymentStatus","Failed","Successful","Pending","env","process","defaultBaseName","packageJson","config","baseName","BASE_NAME","backendUrl","BACKEND","defaultTitle","defaultColor","defaultLineSize","thumbnails","width","height","auth","domain","AUTH_TENANT","baseUrl","audience","clientId","AUTH_CLIENT_ID","redirectUrl","AUTH_REDIRECT_URL","google","GOOGLE_CLIENT_ID","admin","path","models","keys","stripe","STRIPE_KEY","paypal","PAYPAL_KEY","createOffscreen","dpr","offline","OffscreenCanvas","canvas","getContext","scale","adjustOffscreenResolution","context","strokeStyle","lineWidth","lineCap","lineJoin","setBrushDefaults","w","self","send","background","data","getImageData","postMessage","err","console","error","onmessage","buffer","stream","stopAt","i","t","x","y","c","Open","beginPath","Stroke","includes","lineTo","stroke","Close","closePath","processHistory","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","__webpack_exports__","O","deferred","result","chunkIds","fn","priority","notFulfilled","Infinity","length","fulfilled","j","Object","every","key","splice","r","d","definition","o","defineProperty","enumerable","get","f","e","chunkId","Promise","all","reduce","promises","u","miniCssF","obj","prop","prototype","hasOwnProperty","call","p","installedChunks","importScripts","chunkLoadingGlobal","parentChunkLoadingFunction","push","bind","moreModules","runtime","pop","next","then"],"sourceRoot":""}